先に全ての点に対してk-近傍法を実施し、その結果をスタックしておけば、実際の利用時に一瞬でわかるはず